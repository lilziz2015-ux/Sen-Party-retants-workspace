<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendar ‚Äî Sen Party Rentals Pro</title>
<link rel="stylesheet" href="assets/style.css">

<style>
:root {
  --brand: #0078ff;
  --brand-dark: #004c99;
  --muted: #6b7280;
  --bg: #f8fafc;
  --white: #fff;
  --green: #19a974;
  --yellow: #f2c94c;
}

body {
  margin: 0;
  font-family: "Segoe UI", sans-serif;
  background: var(--bg);
  color: #1f2937;
  display: flex;
  min-height: 100vh;
}

/* Sidebar */
.sidebar {
  width: 260px;
  background: var(--white);
  border-right: 1px solid #e5e7eb;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  position: fixed;
  top: 0; left: 0; bottom: 0;
  padding: 1rem;
  transition: transform 0.3s ease;
  z-index: 1000;
}
.sidebar.hidden { transform: translateX(-100%); }
.sidebar .logo { text-align: center; }
.sidebar img { width: 80px; border-radius: 50%; margin-bottom: 0.5rem; }
.sidebar nav { display: flex; flex-direction: column; gap: 0.6rem; margin-top: 1rem; }
.sidebar nav a {
  text-decoration: none; color: #1f2937; padding: 0.6rem 0.8rem;
  border-radius: 6px; transition: 0.2s;
}
.sidebar nav a:hover, .sidebar nav a.active {
  background: #e6f0ff; color: var(--brand-dark); font-weight: 600;
}

/* Main */
.main { flex: 1; margin-left: 260px; padding: 2rem; }
.topbar {
  display: flex; justify-content: space-between; align-items: center;
  flex-wrap: wrap; margin-bottom: 2rem;
}
.menu-toggle {
  display: none; background: var(--brand); color: #fff; border: none;
  padding: 0.6rem 0.9rem; border-radius: 6px; font-size: 1.2rem; cursor: pointer;
}
.muted { color: var(--muted); }

/* Calendar */
.calendar-container {
  background: var(--white);
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
.calendar-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 1rem;
}
.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 6px;
}
.calendar-day {
  background: #fff;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  padding: 8px;
  min-height: 100px;
  position: relative;
  transition: 0.2s;
  cursor: pointer;
}
.calendar-day:hover {
  background: #eef6ff;
}
.calendar-day h4 {
  margin: 0;
  font-size: 0.9rem;
  font-weight: 600;
}
.event {
  font-size: 0.75rem;
  border-radius: 6px;
  margin-top: 4px;
  padding: 2px 4px;
  color: #fff;
}
.event.delivery { background: var(--green); }
.event.pickup { background: var(--yellow); color: #000; }

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  visibility: hidden;
}
.modal.active { visibility: visible; }
.modal-content {
  background: #fff;
  border-radius: 12px;
  padding: 20px;
  width: 90%;
  max-width: 400px;
}
.modal-content h3 { margin-top: 0; }

@media (max-width: 900px) {
  .main { margin-left: 0; }
  .menu-toggle { display: block; margin-bottom: 1rem; }
  .sidebar { transform: translateX(-100%); }
  .sidebar.show { transform: translateX(0); }
}
</style>
</head>

<body>

<!-- Sidebar -->
<aside class="sidebar hidden" id="sidebar">
  <div class="logo">
    <img src="02B58D79-6737-47EA-8099-73006879E55A Small.jpeg" alt="Logo">
    <h2>Sen Party Rentals Pro</h2>
  </div>
  <nav>
    <a href="index.html">üè† Dashboard</a>
    <a href="bookings.html">üìÖ Bookings</a>
    <a href="calendar.html" class="active">üóìÔ∏è Calendar</a>
    <a href="customers.html">üë• Customers</a>
    <a href="invoices.html">üßæ Invoices</a>
    <a href="delivery.html">üöö Delivery</a>
    <a href="settings.html">‚öôÔ∏è Settings</a>
  </nav>
</aside>

<!-- Main -->
<main class="main">
  <header class="topbar">
    <button class="menu-toggle" id="menuToggle">‚ò∞</button>
    <div>
      <h1>Booking Calendar</h1>
      <p class="muted">View all bookings by date and type.</p>
    </div>
  </header>

  <section class="calendar-container">
    <div class="calendar-header">
      <button id="prevMonth" class="btn">‚óÄ</button>
      <h2 id="monthLabel"></h2>
      <button id="nextMonth" class="btn">‚ñ∂</button>
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </section>

  <footer>
    <p>¬© 2025 Sen Party Rentals Pro ‚Äî Calendar</p>
  </footer>
</main>

<!-- Booking details modal -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3 id="modalDate"></h3>
    <ul id="modalList"></ul>
    <button id="closeModal" class="btn-primary" style="margin-top:10px;">Close</button>
  </div>
</div>

<script type="module">
// === Sidebar toggle ===
const sidebar = document.getElementById("sidebar");
const toggleBtn = document.getElementById("menuToggle");
toggleBtn.addEventListener("click", () => {
  sidebar.classList.toggle("hidden");
  sidebar.classList.toggle("show");
});

// === Local storage sync ===
function getBookings() {
  return JSON.parse(localStorage.getItem("spr.bookings") || "[]");
}

// === Calendar logic ===
document.addEventListener("DOMContentLoaded", () => {
  const grid = document.getElementById("calendarGrid");
  const monthLabel = document.getElementById("monthLabel");
  const modal = document.getElementById("modal");
  const modalDate = document.getElementById("modalDate");
  const modalList = document.getElementById("modalList");
  const closeModal = document.getElementById("closeModal");

  let current = new Date();
  let bookings = getBookings();

  function renderCalendar() {
    grid.innerHTML = "";
    const year = current.getFullYear();
    const month = current.getMonth();
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    monthLabel.textContent = current.toLocaleString("default", { month: "long", year: "numeric" });

    // Fill empty days before the first
    for (let i = 0; i < firstDay; i++) {
      const empty = document.createElement("div");
      empty.classList.add("calendar-day");
      grid.appendChild(empty);
    }

    // Fill calendar days
    for (let day = 1; day <= daysInMonth; day++) {
      const dateISO = `${year}-${String(month + 1).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
      const dayBookings = bookings.filter(b => b.date === dateISO);
      const cell = document.createElement("div");
      cell.classList.add("calendar-day");
      cell.innerHTML = `<h4>${day}</h4>`;
      dayBookings.forEach(b => {
        const event = document.createElement("div");
        event.classList.add("event", b.type);
        event.textContent = b.customer || "Booking";
        cell.appendChild(event);
      });
      cell.addEventListener("click", () => openModal(dateISO, dayBookings));
      grid.appendChild(cell);
    }
  }

  function openModal(date, list) {
    modal.classList.add("active");
    modalDate.textContent = `Bookings on ${date}`;
    modalList.innerHTML = list.length
      ? list.map(b => `<li>${b.customer} (${b.type === "delivery" ? "üü¢ Delivery" : "üü° Pickup"}) - $${b.total.toFixed(2)}</li>`).join("")
      : "<li class='muted'>No bookings.</li>";
  }

  closeModal.onclick = () => modal.classList.remove("active");

  // Sync updates automatically
  window.addEventListener("bookingsUpdated", () => {
    bookings = getBookings();
    renderCalendar();
  });

  document.getElementById("prevMonth").onclick = () => {
    current.setMonth(current.getMonth() - 1);
    renderCalendar();
  };
  document.getElementById("nextMonth").onclick = () => {
    current.setMonth(current.getMonth() + 1);
    renderCalendar();
  };

  renderCalendar();
});
</script>
</body>
</html>